{% extends "base.njk" %}

{% block content %}
    <!-- 装饰性背景元素 -->
    <div class="fixed -z-10 top-0 left-0 w-full h-full overflow-hidden pointer-events-none">
        <div class="absolute top-20 left-10 w-64 h-64 bg-primary/5 rounded-full filter blur-3xl"></div>
        <div class="absolute bottom-20 right-10 w-80 h-80 bg-secondary/5 rounded-full filter blur-3xl"></div>
    </div>

    <!-- 文章整体容器（保持原有布局） -->
    <div class="max-w-4xl mx-auto px-4 py-6 relative">
        <!-- 移动端导航与内容区整合（保持原样） -->
        <div class="mb-8">
            <!-- 文章头部信息 -->
            <div class="flex flex-col md:flex-row md:items-center justify-between gap-4 mb-6">
                <a href="{{ config.baseUrl }}/page/1/" class="flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors">
                    <i class="fa fa-arrow-left"></i>
                    <span>返回首页</span>
                </a>
                
                <div class="flex items-center gap-3 text-sm text-gray-500 dark:text-gray-400">
                    <span class="flex items-center gap-1">
                        <i class="fa fa-calendar-o"></i>
                        <time>{{ post.date | date('yyyy-MM-dd') }}</time>
                    </span>
                    {% if post.readingTime %}
                        <span class="flex items-center gap-1">
                            <i class="fa fa-clock-o"></i>
                            <span>{{ post.readingTime }} 分钟</span>
                        </span>
                    {% endif %}
                </div>
            </div>
            
            <!-- 文章标题 -->
            <h1 class="text-2xl md:text-3xl lg:text-4xl font-bold mb-6 text-gray-900 dark:text-gray-100 leading-tight tracking-tight">
                {{ post.title }}
            </h1>
            
            <!-- 标签区域 -->
            {% if post.tags and post.tags.length > 0 %}
                <div class="flex flex-wrap gap-2 mb-8">
                    {% for tag in post.tags %}
                        <a href="{{ config.baseUrl }}/tags/{{ tag }}/" class="inline-flex items-center gap-1 px-3 py-1.5 bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded-full text-sm hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">
                            <i class="fa fa-hashtag text-xs"></i>
                            {{ tag }}
                        </a>
                    {% endfor %}
                </div>
            {% endif %}
        </div>
        
        <!-- 文章封面图（保持原样） -->
        {% if post.cover %}
            <div class="mb-8 rounded-xl overflow-hidden shadow-md">
                <img src="{{  (config.baseUrl + post.cover) }}" alt="{{ post.title }}的封面图" class="w-full h-auto object-cover transform hover:scale-[1.02] transition-transform duration-500">
            </div>
        {% endif %}
        
        <!-- 核心：仅对文章内容部分应用视角窗口 -->
        <!-- 内容区容器：固定90%宽度、居中、允许横向滚动 -->
        <div class="max-w-[90vw] mx-auto mb-10">
            <div class="overflow-x-auto pb-4 scrollbar-thin scrollbar-thumb-gray-300 dark:scrollbar-thumb-gray-700">
                <!-- 内容内层容器：确保短内容不收缩 -->
                <div class="min-w-full">
                    <!-- 文章内容区 -->
                    <div class="post-content prose prose-lg max-w-none dark:prose-invert prose-a:text-primary">
                        <style>
                            /* 仅针对文章内容的样式 */
                            .post-content {
                                padding: 0 0.5rem; /* 内容内边距，避免贴边 */
                            }

                            /* 移动端适配 */
                            @media (max-width: 767px) {
                                .post-content {
                                    font-size: 16px !important;
                                    line-height: 1.8 !important;
                                }
                                
                                /* 普通文本自动换行 */
                                .post-content p,
                                .post-content li,
                                .post-content blockquote {
                                    word-break: break-word;
                                    overflow-wrap: break-word;
                                }
                                
                                /* 标题处理 */
                                .post-content h2,
                                .post-content h3 {
                                    word-break: break-word;
                                    margin-top: 1.5rem !important;
                                    margin-bottom: 0.8rem !important;
                                }
                                
                                /* 超长元素（表格、代码块）允许横向滚动 */
                                .post-content table,
                                .post-content pre,
                                .post-content img {
                                    min-width: 100%; /* 确保与容器同宽 */
                                    max-width: none !important; /* 取消最大宽度限制，允许内容自然扩展 */
                                }
                                
                                /* 代码块样式 */
                                .post-content pre {
                                    font-size: 0.875rem !important;
                                    padding: 1rem !important;
                                }
                                
                                /* 图片保持自适应 */
                                .post-content img {
                                    height: auto !important;
                                    margin: 1.5rem auto !important;
                                }
                            }

                            /* 滚动条美化 */
                            ::-webkit-scrollbar {
                                height: 6px;
                            }
                            ::-webkit-scrollbar-track {
                                background: transparent;
                            }
                            ::-webkit-scrollbar-thumb {
                                background-color: rgba(156, 163, 175, 0.5);
                                border-radius: 3px;
                            }
                            ::-webkit-scrollbar-thumb:hover {
                                background-color: rgba(156, 163, 175, 0.8);
                            }
                        </style>
                        
                        {{ post.content | safe }}
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 文章末尾装饰（保持原样） -->
        <div class="mt-6 flex justify-center">
            <div class="w-20 h-1 bg-gradient-to-r from-transparent via-primary to-transparent"></div>
        </div>
        
        <!-- 分享区域（保持原样） -->
        <div class="mt-10 pt-6 border-t border-gray-200 dark:border-gray-800">
            <h3 class="text-lg font-medium mb-4 flex items-center gap-2 text-gray-700 dark:text-gray-300">
                <i class="fa fa-share-alt text-primary"></i>
                分享本文
            </h3>
            <div class="flex gap-3">
                <a href="https://twitter.com/intent/tweet?url={{ config.baseUrl }}/posts/{{ post.slug }}/&text={{ post.title }}" target="_blank" rel="noopener" class="w-10 h-10 rounded-full bg-[#1DA1F2]/10 text-[#1DA1F2] flex items-center justify-center hover:bg-[#1DA1F2]/20 transition-colors">
                    <i class="fa fa-twitter"></i>
                </a>
                <a href="https://www.facebook.com/sharer/sharer.php?u={{ config.baseUrl }}/posts/{{ post.slug }}/" target="_blank" rel="noopener" class="w-10 h-10 rounded-full bg-[#1877F2]/10 text-[#1877F2] flex items-center justify-center hover:bg-[#1877F2]/20 transition-colors">
                    <i class="fa fa-facebook"></i>
                </a>
                <a href="javascript:window.open('https://wx.qq.com/cgi-bin/mmwebwx-bin/webwxcheckurl?requrl={{ config.baseUrl }}/posts/{{ post.slug }}/&skey=&device=0&pass_ticket=&op=2', '_blank', 'width=600,height=400')" class="w-10 h-10 rounded-full bg-[#07C160]/10 text-[#07C160] flex items-center justify-center hover:bg-[#07C160]/20 transition-colors">
                    <i class="fa fa-weixin"></i>
                </a>
                <button onclick="navigator.clipboard.writeText('{{ config.baseUrl }}/posts/{{ post.slug }}/').then(() => alert('链接已复制！'))" class="w-10 h-10 rounded-full bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 flex items-center justify-center hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">
                    <i class="fa fa-link"></i>
                </button>
            </div>
        </div>
    </div>
{% endblock %}